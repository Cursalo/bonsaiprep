{"ast":null,"code":"// src/services/aiService.ts\n// Define the structure for a generated question\n// Interface for topic difficulty information\n// Interface for section information\n// Interface for parsed SAT test data\n// Use environment variable for API key but rename it to be more generic\nconst ANALYSIS_API_KEY=process.env.REACT_APP_GEMINI_API_KEY;const ANALYSIS_API_URL=\"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent\";// Function to simulate processing delay\nconst addProcessingDelay=ms=>new Promise(resolve=>setTimeout(resolve,ms));/**\n * Parse SAT report text to extract information about incorrect answers\n */const parseSATReport=reportText=>{const lines=reportText.split('\\n');// Initialize data structure\nconst data={sections:{'Reading and Writing':{correct:0,incorrect:0,total:0,incorrectQuestions:[]},'Math':{correct:0,incorrect:0,total:0,incorrectQuestions:[]}},totalCorrect:0,totalIncorrect:0,totalQuestions:0};// First look for the summary data if available\nconst totalQuestionsMatch=reportText.match(/(\\d+)\\s*Total Questions/);const correctAnswersMatch=reportText.match(/(\\d+)\\s*Correct Answers/);const incorrectAnswersMatch=reportText.match(/(\\d+)\\s*Incorrect Answers/);if(totalQuestionsMatch){data.totalQuestions=parseInt(totalQuestionsMatch[1]);}if(correctAnswersMatch){data.totalCorrect=parseInt(correctAnswersMatch[1]);}if(incorrectAnswersMatch){data.totalIncorrect=parseInt(incorrectAnswersMatch[1]);}// Try to extract information about each section's difficulty level\nconst sectionInfoRegex=/(Information and Ideas|Expression of Ideas|Craft and Structure|Standard English Conventions|Algebra|Advanced Math|Problem-Solving and Data Analysis|Geometry and Trigonometry)\\s*\\((\\d+)%[^)]*\\)(?:[^)]*Diﬃculty level: (Easy|Medium|Hard))?/g;let sectionMatch;while((sectionMatch=sectionInfoRegex.exec(reportText))!==null){const topic=sectionMatch[1];const percentage=parseInt(sectionMatch[2]);const difficulty=sectionMatch[3]||\"Medium\";// Map topics to main sections\nlet mainSection='';if(['Information and Ideas','Expression of Ideas','Craft and Structure','Standard English Conventions'].includes(topic)){mainSection='Reading and Writing';}else{mainSection='Math';}// Store this information for potential use in question generation\nif(!data.sectionInfo){data.sectionInfo={};}if(!data.sectionInfo[mainSection]){data.sectionInfo[mainSection]={};}data.sectionInfo[mainSection][topic]={percentage,difficulty};}// Extract test data row by row from the questions table\nconst questionRegex=/^\\s*(\\d+)\\s+(Reading and Writing|Math)\\s+([A-D0-9/\\., ]+)\\s+([A-D0-9/\\., ]+);?\\s*(Correct|Incorrect)/;for(const line of lines){const questionMatch=line.match(questionRegex);if(questionMatch){const[_,questionNumber,section,correctAnswer,yourAnswer,status]=questionMatch;if(section in data.sections){data.sections[section].total+=1;if(status==='Correct'){data.sections[section].correct+=1;}else{data.sections[section].incorrect+=1;data.sections[section].incorrectQuestions.push({questionNumber,correctAnswer:correctAnswer.trim(),yourAnswer:yourAnswer.trim()});}}}}// If we couldn't parse the summary data directly, calculate from question data\nif(data.totalQuestions===0){data.totalCorrect=Object.values(data.sections).reduce((sum,section)=>sum+section.correct,0);data.totalIncorrect=Object.values(data.sections).reduce((sum,section)=>sum+section.incorrect,0);data.totalQuestions=data.totalCorrect+data.totalIncorrect;}return data;};/**\n * Determines the main topics for each section based on mistakes\n */const determineTopics=section=>{if(section==='Reading and Writing'){return['Information and Ideas','Expression of Ideas','Craft and Structure','Standard English Conventions'];}else if(section==='Math'){return['Algebra','Advanced Math','Problem-Solving and Data Analysis','Geometry and Trigonometry'];}return['General Knowledge'];};/**\n * Creates a prompt for the analysis engine to generate SAT practice questions\n */const createAnalysisPrompt=satData=>{var _satData$sections$Rea,_satData$sections$Mat;const incorrectRWCount=((_satData$sections$Rea=satData.sections['Reading and Writing'])===null||_satData$sections$Rea===void 0?void 0:_satData$sections$Rea.incorrect)||0;const incorrectMathCount=((_satData$sections$Mat=satData.sections['Math'])===null||_satData$sections$Mat===void 0?void 0:_satData$sections$Mat.incorrect)||0;let prompt=\"As an expert SAT tutor, create 10 unique SAT practice questions tailored to this student's specific performance on a recent SAT practice test.\\n\\nSTUDENT'S SAT REPORT SUMMARY:\\n- Reading and Writing section: \".concat(satData.sections['Reading and Writing'].correct,\" correct, \").concat(satData.sections['Reading and Writing'].incorrect,\" incorrect\\n- Math section: \").concat(satData.sections['Math'].correct,\" correct, \").concat(satData.sections['Math'].incorrect,\" incorrect\\n- Total score: \").concat(satData.totalCorrect,\" out of \").concat(satData.totalQuestions,\"\\n\");// Add details about section difficulty levels if available\nif(satData.sectionInfo){prompt+=\"\\nSECTION DIFFICULTY INFORMATION:\\n\";for(const[section,topics]of Object.entries(satData.sectionInfo)){prompt+=\"\".concat(section,\":\\n\");for(const[topic,info]of Object.entries(topics)){prompt+=\"- \".concat(topic,\": \").concat(info.difficulty,\" difficulty (\").concat(info.percentage,\"% of section)\\n\");}}}// Add details about incorrect questions\nif(incorrectRWCount>0){prompt+=\"\\nREADING AND WRITING MISTAKES:\\n\";satData.sections['Reading and Writing'].incorrectQuestions.forEach(q=>{prompt+=\"- Question \".concat(q.questionNumber,\": Student answered \\\"\").concat(q.yourAnswer,\"\\\" but correct answer was \\\"\").concat(q.correctAnswer,\"\\\"\\n\");});}if(incorrectMathCount>0){prompt+=\"\\nMATH MISTAKES:\\n\";satData.sections['Math'].incorrectQuestions.forEach(q=>{prompt+=\"- Question \".concat(q.questionNumber,\": Student answered \\\"\").concat(q.yourAnswer,\"\\\" but correct answer was \\\"\").concat(q.correctAnswer,\"\\\"\\n\");});}// Analyze weak areas\nlet readingWeakTopics=[];let mathWeakTopics=[];if(satData.sectionInfo){// For Reading and Writing, find topics with Hard difficulty\nif(satData.sectionInfo['Reading and Writing']){readingWeakTopics=Object.entries(satData.sectionInfo['Reading and Writing']).filter(_ref=>{let[_,info]=_ref;return info.difficulty==='Hard'||incorrectRWCount>5;}).map(_ref2=>{let[topic,_]=_ref2;return topic;});}// For Math, find topics with Hard difficulty\nif(satData.sectionInfo['Math']){mathWeakTopics=Object.entries(satData.sectionInfo['Math']).filter(_ref3=>{let[_,info]=_ref3;return info.difficulty==='Hard'||incorrectMathCount>5;}).map(_ref4=>{let[topic,_]=_ref4;return topic;});}}// If we couldn't determine weak topics from section info, use default distribution\nif(readingWeakTopics.length===0){readingWeakTopics=['Information and Ideas','Expression of Ideas','Craft and Structure','Standard English Conventions'];}if(mathWeakTopics.length===0){mathWeakTopics=['Algebra','Advanced Math','Problem-Solving and Data Analysis','Geometry and Trigonometry'];}// Distribution of questions based on where student needs more practice\nconst rwQuestions=incorrectRWCount>0?Math.ceil(incorrectRWCount/(incorrectRWCount+incorrectMathCount)*10):0;const mathQuestions=10-rwQuestions;prompt+=\"\\nBased on the student's performance, please create:\\n\".concat(rwQuestions>0?\"- \".concat(rwQuestions,\" Reading and Writing questions focusing on: \").concat(readingWeakTopics.join(', ')):'',\"\\n\").concat(rwQuestions>0&&mathQuestions>0?'\\n':'').concat(mathQuestions>0?\"- \".concat(mathQuestions,\" Math questions focusing on: \").concat(mathWeakTopics.join(', ')):'',\"\\n\\nFor Reading and Writing questions, cover these difficult topic areas:\\n- Information and Ideas (comprehending texts, locating information)\\n- Expression of Ideas (development, organization, effective language use)\\n- Craft and Structure (word choice, text structure, point of view)\\n- Standard English Conventions (grammar, usage, mechanics)\\n\\nFor Math questions, cover these topic areas:\\n- Algebra (linear equations, systems, functions)\\n- Advanced Math (quadratics, exponents, polynomials)\\n- Problem-Solving and Data Analysis (ratios, percentages, statistics)\\n- Geometry and Trigonometry (shapes, angles, triangles)\\n\\nFORMAT INSTRUCTIONS:\\nReturn your response as a JSON array containing exactly 10 question objects with these fields:\\n- id: A unique string identifier (e.g., \\\"rw-info-1\\\")\\n- text: The question text\\n- topic: The specific topic area (e.g., \\\"Algebra\\\", \\\"Information and Ideas\\\")\\n- difficulty: \\\"Easy\\\", \\\"Medium\\\", or \\\"Hard\\\"\\n- options: Array of 4 answer choices for multiple-choice questions\\n- answer: The correct answer (letter A-D for multiple choice or exact answer for grid-ins)\\n- explanation: Detailed explanation of the correct answer\\n\\nIMPORTANT REQUIREMENTS:\\n1. Focus on the student's weak areas identified in the SAT report.\\n2. For Reading questions: Create multiple-choice questions similar to those in SAT Reading.\\n3. For Math questions: Create both multiple-choice and student-produced response questions (grid-ins).\\n4. All questions should be original and at appropriate SAT difficulty level.\\n5. Include high-quality explanations that teach the concept.\\n6. Ensure questions reflect real SAT format and content.\\n7. ENSURE THE RESPONSE IS VALID JSON that can be parsed with JSON.parse().\\n\\nExample format for ONE question (you'll provide 10):\\n{\\n  \\\"id\\\": \\\"math-alg-1\\\",\\n  \\\"text\\\": \\\"If f(x) = 3x\\xB2 - 4x + 2, what is the value of f(2)?\\\",\\n  \\\"topic\\\": \\\"Algebra\\\",\\n  \\\"difficulty\\\": \\\"Medium\\\",\\n  \\\"options\\\": [\\\"6\\\", \\\"8\\\", \\\"10\\\", \\\"12\\\"],\\n  \\\"answer\\\": \\\"C\\\",\\n  \\\"explanation\\\": \\\"f(2) = 3(2)\\xB2 - 4(2) + 2 = 3(4) - 8 + 2 = 12 - 8 + 2 = 6 + 2 = 10\\\"\\n}\");return prompt;};/**\n * Calls the external API to generate content\n */const callContentAPI=async prompt=>{if(!ANALYSIS_API_KEY){throw new Error(\"API key not configured\");}const apiUrl=\"\".concat(ANALYSIS_API_URL,\"?key=\").concat(ANALYSIS_API_KEY);const payload={contents:[{parts:[{text:prompt}]}],generationConfig:{temperature:0.7,maxOutputTokens:8192}};const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){const errorText=await response.text();throw new Error(\"API response error: \".concat(response.status,\" \").concat(errorText));}const data=await response.json();console.log(\"API response received:\",data);// Extract the generated text from the response\nlet generatedText=\"\";try{generatedText=data.candidates[0].content.parts[0].text;}catch(e){console.error(\"Error extracting text from API response:\",e);throw new Error(\"Unexpected API response format\");}return generatedText;};/**\n * Extracts structured question data from the API response\n */const extractQuestionsFromResponse=response=>{try{// Find JSON array in the response (model might include other text before or after)\nlet jsonContent=response;// If the response contains markdown code blocks, extract just the JSON part\nconst jsonMatch=response.match(/```(?:json)?\\s*(\\[[\\s\\S]*?\\])\\s*```/);if(jsonMatch&&jsonMatch[1]){jsonContent=jsonMatch[1];}// Sometimes the model may wrap JSON in an object instead of returning an array directly\n// Check if we have a JSON object with a questions array\nconst objectMatch=jsonContent.match(/\\{\\s*\"questions\"\\s*:\\s*(\\[[\\s\\S]*?\\])\\s*\\}/);if(objectMatch&&objectMatch[1]){jsonContent=objectMatch[1];}// Clean up any non-JSON content that might exist\njsonContent=jsonContent.trim();if(!jsonContent.startsWith('[')){const startPos=jsonContent.indexOf('[');if(startPos>=0){jsonContent=jsonContent.substring(startPos);}}if(!jsonContent.endsWith(']')){const endPos=jsonContent.lastIndexOf(']');if(endPos>=0){jsonContent=jsonContent.substring(0,endPos+1);}}// Parse the JSON content\nconst questions=JSON.parse(jsonContent);// Validate that we have an array of questions with required properties\nif(!Array.isArray(questions)){throw new Error(\"Parsed content is not an array\");}// Ensure each question has required fields\nreturn questions.map((q,index)=>({id:q.id||\"question-\".concat(Date.now(),\"-\").concat(index),text:q.text||'Question text unavailable',topic:q.topic||'General',difficulty:q.difficulty,options:q.options,answer:q.answer,explanation:q.explanation}));}catch(error){console.error(\"Error parsing API response:\",error,\"Raw response:\",response);throw new Error(\"Failed to parse questions from API response: \".concat(error.message));}};/**\n * Generates practice questions based on extracted text from an SAT report.\n * \n * @param extractedMistakesText The text extracted from the SAT report.\n * @returns A promise that resolves to an array of GeneratedQuestion objects.\n */export const generateQuestionsFromMistakes=async extractedMistakesText=>{console.log(\"Attempting to generate questions for text:\",extractedMistakesText.substring(0,300)+\"...\");if(!extractedMistakesText||extractedMistakesText.trim()===\"\"){console.warn(\"No text provided for question generation.\");return[];}try{// 1. Parse the SAT report to understand mistakes\nconst satData=parseSATReport(extractedMistakesText);console.log(\"Parsed SAT data:\",satData);// Add a processing delay to simulate complex analysis\nawait addProcessingDelay(3000);// 2. Generate questions based on the report\ntry{// 2a. First try to use the advanced API if the key is available\nif(ANALYSIS_API_KEY){console.log(\"Generating tailored questions using advanced analysis\");const prompt=createAnalysisPrompt(satData);// Add additional delay to simulate API processing time\nawait addProcessingDelay(2000);const analysisResponse=await callContentAPI(prompt);const generatedQuestions=extractQuestionsFromResponse(analysisResponse);// Ensure we have exactly 10 questions\nif(generatedQuestions.length<10){const remainingQuestions=generateFallbackQuestions(extractedMistakesText,10-generatedQuestions.length);return[...generatedQuestions,...remainingQuestions];}else if(generatedQuestions.length>10){return generatedQuestions.slice(0,10);}return generatedQuestions;}else{console.warn(\"No advanced analysis API key found. Using standard question generation.\");throw new Error(\"Analysis API key not configured\");}}catch(apiError){console.error(\"Error using analysis API:\",apiError);// 2b. If API call fails, fall back to the template-based approach\nconsole.log(\"Falling back to template-based question generation\");// Add a delay to simulate advanced processing\nawait addProcessingDelay(2500);const questions=[];// Get sections where mistakes were made\nconst sectionsWithMistakes=Object.entries(satData.sections).filter(_ref5=>{let[_,data]=_ref5;return data.incorrect>0;}).sort((a,b)=>b[1].incorrect-a[1].incorrect);// If we have sections with mistakes, generate questions for those\nif(sectionsWithMistakes.length>0){// Determine how many questions per section\nconst totalSections=sectionsWithMistakes.length;const questionsPerSection=Math.ceil(10/totalSections);// Generate questions for each section\nfor(const[section,data]of sectionsWithMistakes){const topics=determineTopics(section);for(let i=0;i<Math.min(questionsPerSection,data.incorrect,10);i++){const topic=topics[Math.floor(Math.random()*topics.length)];questions.push(generateQuestionForTopic(section,topic,i));if(questions.length>=10)break;}if(questions.length>=10)break;}}// If we still don't have 10 questions, add more generic ones\nwhile(questions.length<10){const section=Object.keys(satData.sections)[Math.floor(Math.random()*Object.keys(satData.sections).length)];const topics=determineTopics(section);const topic=topics[Math.floor(Math.random()*topics.length)];questions.push(generateQuestionForTopic(section,topic,questions.length));}console.log(\"Generated questions:\",questions);return questions;}}catch(error){console.error(\"Error parsing SAT report:\",error);return generateFallbackQuestions(extractedMistakesText,10);}};/**\n * Generates a question for a specific topic\n */const generateQuestionForTopic=(section,topic,index)=>{// Create varied questions for each topic based on the index\nif(section==='Reading and Writing'){if(topic==='Information and Ideas'){// Information and Ideas question variants\nconst questions=[{id:\"rw-info-\".concat(Date.now(),\"-\").concat(index),text:\"Which statement best summarizes the main idea of the passage?\",topic:\"Information and Ideas\",difficulty:\"Medium\",options:[\"The economic impact of renewable energy on global markets\",\"The scientific advancements that enable modern solar technology\",\"The historical development of energy technology across cultures\",\"The environmental benefits of transitioning to renewable energy sources\"],answer:\"D\",explanation:\"The passage primarily discusses the environmental benefits of renewable energy rather than focusing on economic, scientific, or historical aspects.\"},{id:\"rw-info-\".concat(Date.now(),\"-\").concat(index),text:\"Which detail from the passage best supports the author's claim about climate impacts?\",topic:\"Information and Ideas\",difficulty:\"Hard\",options:[\"The statistical analysis of temperature changes over fifty years\",\"The quotation from the environmental scientist in paragraph 3\",\"The comparison between different energy production methods\",\"The reference to the international climate agreement\"],answer:\"B\",explanation:\"The quotation from the environmental scientist provides specific evidence that directly supports the author's central claim about climate impacts.\"},{id:\"rw-info-\".concat(Date.now(),\"-\").concat(index),text:\"Based on the passage, what can be inferred about the relationship between technology and sustainability?\",topic:\"Information and Ideas\",difficulty:\"Medium\",options:[\"Technological advancement always leads to environmental degradation\",\"Sustainability goals can be achieved without technological innovation\",\"Technology can be harnessed to address environmental challenges\",\"Environmental concerns are secondary to technological progress\"],answer:\"C\",explanation:\"The passage implies that properly directed technological innovation can help address environmental challenges rather than exacerbate them.\"},{id:\"rw-info-\".concat(Date.now(),\"-\").concat(index),text:\"What conclusion about renewable energy is best supported by the data presented in the passage?\",topic:\"Information and Ideas\",difficulty:\"Medium\",options:[\"It is more cost-effective than fossil fuels in all contexts\",\"Its adoption is growing faster in developing countries than in industrialized nations\",\"It has the potential to significantly reduce carbon emissions\",\"It will completely replace traditional energy sources within a decade\"],answer:\"C\",explanation:\"The data in the passage directly supports the conclusion that renewable energy can significantly reduce carbon emissions, without making unsupported claims about cost-effectiveness, adoption rates, or timeline predictions.\"}];return questions[index%questions.length];}else if(topic==='Expression of Ideas'){// Expression of Ideas question variants\nconst questions=[{id:\"rw-expr-\".concat(Date.now(),\"-\").concat(index),text:\"Which sentence would most effectively establish the main idea of the paragraph?\",topic:\"Expression of Ideas\",difficulty:\"Medium\",options:[\"The author's opinion represents only one perspective on the issue.\",\"Research indicates that several factors contribute to this phenomenon.\",\"Traditional approaches to solving this problem have proven ineffective.\",\"Personal biases often influence how people interpret complex data.\"],answer:\"C\",explanation:\"This option establishes context and signals that the paragraph will explore new approaches, creating a clear focus.\"},{id:\"rw-expr-\".concat(Date.now(),\"-\").concat(index),text:\"Which revision most effectively combines these two sentences?\\n'The museum opened a new exhibit. The exhibit features artifacts from ancient Egypt.'\",topic:\"Expression of Ideas\",difficulty:\"Easy\",options:[\"The museum opened a new exhibit and features artifacts from ancient Egypt.\",\"The museum opened a new exhibit, it features artifacts from ancient Egypt.\",\"The museum opened a new exhibit that features artifacts from ancient Egypt.\",\"The museum, opening a new exhibit, features artifacts from ancient Egypt.\"],answer:\"C\",explanation:\"This revision most effectively combines the sentences using a relative clause that clearly shows the relationship between the exhibit and the artifacts.\"},{id:\"rw-expr-\".concat(Date.now(),\"-\").concat(index),text:\"Which transition would best connect the ideas in these two paragraphs?\",topic:\"Expression of Ideas\",difficulty:\"Medium\",options:[\"Furthermore\",\"Nevertheless\",\"For example\",\"In conclusion\"],answer:\"B\",explanation:\"Since the second paragraph presents a contrasting perspective to the first, 'Nevertheless' is the most appropriate transition to indicate this shift.\"},{id:\"rw-expr-\".concat(Date.now(),\"-\").concat(index),text:\"Where should this sentence be placed to best support the paragraph's main argument?\\n'Recent studies have confirmed this trend across multiple demographics.'\",topic:\"Expression of Ideas\",difficulty:\"Medium\",options:[\"Before the topic sentence to foreshadow the argument\",\"After the first supporting point as additional evidence\",\"After the counterargument to strengthen the rebuttal\",\"At the end of the paragraph as a concluding thought\"],answer:\"B\",explanation:\"Placing this sentence after the first supporting point provides additional evidence that strengthens the initial claim, creating a more compelling argument.\"}];return questions[index%questions.length];}else if(topic==='Craft and Structure'){// Craft and Structure question variants\nconst questions=[{id:\"rw-craft-\".concat(Date.now(),\"-\").concat(index),text:\"What purpose does the author's reference to historical events serve in the passage?\",topic:\"Craft and Structure\",difficulty:\"Hard\",options:[\"To establish credibility through detailed knowledge\",\"To provide context for a contemporary issue\",\"To challenge conventional interpretations of history\",\"To appeal to readers' sense of nostalgia\"],answer:\"B\",explanation:\"The historical references function primarily to provide context that helps readers understand the current situation being discussed.\"},{id:\"rw-craft-\".concat(Date.now(),\"-\").concat(index),text:\"How does the author's use of technical language in paragraph 3 affect the passage?\",topic:\"Craft and Structure\",difficulty:\"Medium\",options:[\"It creates distance between the reader and the subject matter\",\"It emphasizes the complexity and importance of the scientific concepts\",\"It undermines the credibility of competing theories\",\"It shifts the tone from objective to persuasive\"],answer:\"B\",explanation:\"The technical language emphasizes the complexity and scientific significance of the concepts being discussed, adding depth to the author's explanation.\"},{id:\"rw-craft-\".concat(Date.now(),\"-\").concat(index),text:\"In the context of the passage, the word 'paradigm' most nearly means:\",topic:\"Craft and Structure\",difficulty:\"Medium\",options:[\"A contradiction or paradox\",\"An established model or pattern\",\"A temporary solution\",\"An unexpected discovery\"],answer:\"B\",explanation:\"In this context, 'paradigm' refers to an established model or pattern of thinking that shapes how a field approaches problems.\"},{id:\"rw-craft-\".concat(Date.now(),\"-\").concat(index),text:\"How does the structure of the passage develop the author's argument?\",topic:\"Craft and Structure\",difficulty:\"Hard\",options:[\"By presenting a chronological narrative of events\",\"By comparing and contrasting different perspectives\",\"By stating a problem and then proposing solutions\",\"By making a claim and supporting it with increasingly specific evidence\"],answer:\"D\",explanation:\"The passage begins with a general claim and then develops it by providing increasingly specific evidence, creating a logical progression that strengthens the argument.\"}];return questions[index%questions.length];}else{// Standard English Conventions question variants\nconst questions=[{id:\"rw-conv-\".concat(Date.now(),\"-\").concat(index),text:\"Which revision corrects the grammatical error in the sentence?\\n'Neither the students nor the teacher were able to attend the conference.'\",topic:\"Standard English Conventions\",difficulty:\"Medium\",options:[\"Neither the students nor the teacher was able to attend the conference.\",\"Neither the students nor the teacher being able to attend the conference.\",\"Neither the students nor the teacher have been able to attend the conference.\",\"No correction is needed.\"],answer:\"A\",explanation:\"When 'neither/nor' is used, the verb should agree with the noun closer to it (in this case 'teacher'), which requires the singular 'was' rather than 'were'.\"},{id:\"rw-conv-\".concat(Date.now(),\"-\").concat(index),text:\"Which revision corrects the punctuation error in this sentence?\\n'The committee reviewed the proposal however they requested additional information.'\",topic:\"Standard English Conventions\",difficulty:\"Medium\",options:[\"The committee reviewed the proposal, however they requested additional information.\",\"The committee reviewed the proposal; however, they requested additional information.\",\"The committee reviewed the proposal, however, they requested additional information.\",\"The committee reviewed the proposal however, they requested additional information.\"],answer:\"B\",explanation:\"When 'however' joins two independent clauses, it should be preceded by a semicolon and followed by a comma to properly separate the clauses.\"},{id:\"rw-conv-\".concat(Date.now(),\"-\").concat(index),text:\"Which choice correctly uses the apostrophe?\",topic:\"Standard English Conventions\",difficulty:\"Easy\",options:[\"The dog wagged it's tail excitedly.\",\"The companies' new policy affected all employees.\",\"The children's toys were scattered across the floor's.\",\"The building's' entrance was being renovated.\"],answer:\"B\",explanation:\"This option correctly uses the apostrophe after 'companies' to show possession by multiple companies (plural possessive).\"},{id:\"rw-conv-\".concat(Date.now(),\"-\").concat(index),text:\"Which sentence uses parallel structure correctly?\",topic:\"Standard English Conventions\",difficulty:\"Medium\",options:[\"She enjoys swimming, hiking, and to ride bicycles.\",\"The candidate promised to lower taxes, creating jobs, and improving education.\",\"The professor asked students to read the chapter, take notes, and submit a summary.\",\"We can either finish the project today or waiting until tomorrow.\"],answer:\"C\",explanation:\"This sentence correctly maintains parallel structure by using the same verb form (infinitive) for all three actions: 'to read,' 'take,' and 'submit.'\"}];return questions[index%questions.length];}}else{if(topic==='Algebra'){// Algebra question variants\nconst questions=[{id:\"math-alg-\".concat(Date.now(),\"-\").concat(index),text:\"If f(x) = 3x² - 4x + 2, what is the value of f(2)?\",topic:\"Algebra\",difficulty:\"Medium\",options:[\"6\",\"8\",\"10\",\"12\"],answer:\"C\",explanation:\"f(2) = 3(2)² - 4(2) + 2 = 3(4) - 8 + 2 = 12 - 8 + 2 = 6 + 2 = 10\"},{id:\"math-alg-\".concat(Date.now(),\"-\").concat(index),text:\"Solve for x: 2x - 5 = 3x + 7\",topic:\"Algebra\",difficulty:\"Easy\",options:[\"x = -12\",\"x = -1\",\"x = 2\",\"x = 12\"],answer:\"A\",explanation:\"2x - 5 = 3x + 7\\n2x - 3x = 7 + 5\\n-x = 12\\nx = -12\"},{id:\"math-alg-\".concat(Date.now(),\"-\").concat(index),text:\"Which of the following is equivalent to (x + 3)(x - 2)?\",topic:\"Algebra\",difficulty:\"Medium\",options:[\"x² + x - 6\",\"x² + x + 6\",\"x² + 5x - 6\",\"x² - 5x - 6\"],answer:\"A\",explanation:\"(x + 3)(x - 2) = x² - 2x + 3x - 6 = x² + x - 6\"},{id:\"math-alg-\".concat(Date.now(),\"-\").concat(index),text:\"If 3(2x - 4) = 18, what is the value of x?\",topic:\"Algebra\",difficulty:\"Easy\",options:[\"1\",\"3\",\"4\",\"5\"],answer:\"D\",explanation:\"3(2x - 4) = 18\\n6x - 12 = 18\\n6x = 30\\nx = 5\"}];return questions[index%questions.length];}else if(topic==='Advanced Math'){// Advanced Math question variants\nconst questions=[{id:\"math-adv-\".concat(Date.now(),\"-\").concat(index),text:\"Which of the following is equivalent to (2x + 5)(x - 3) - (x + 1)(x - 4)?\",topic:\"Advanced Math\",difficulty:\"Hard\",options:[\"x² - 3x - 17\",\"x² - 5x - 19\",\"x² + 3x - 17\",\"x² + 5x - 19\"],answer:\"B\",explanation:\"(2x + 5)(x - 3) - (x + 1)(x - 4)\\n= 2x² - 6x + 5x - 15 - (x² - 4x + x - 4)\\n= 2x² - x - 15 - x² + 3x + 4\\n= x² - x - 15 + 3x + 4\\n= x² + 2x - 11\"},{id:\"math-adv-\".concat(Date.now(),\"-\").concat(index),text:\"If log₃(x) = 4, what is the value of x?\",topic:\"Advanced Math\",difficulty:\"Medium\",options:[\"12\",\"64\",\"81\",\"243\"],answer:\"C\",explanation:\"If log₃(x) = 4, then 3⁴ = x. So x = 3⁴ = 81.\"},{id:\"math-adv-\".concat(Date.now(),\"-\").concat(index),text:\"Which of the following is equivalent to sin²(θ) + cos²(θ)?\",topic:\"Advanced Math\",difficulty:\"Medium\",options:[\"0\",\"1\",\"tan²(θ)\",\"2sin(θ)cos(θ)\"],answer:\"B\",explanation:\"By the Pythagorean identity, sin²(θ) + cos²(θ) = 1 for all values of θ.\"},{id:\"math-adv-\".concat(Date.now(),\"-\").concat(index),text:\"What is the solution to the equation e^(2x) = 10?\",topic:\"Advanced Math\",difficulty:\"Hard\",options:[\"x = ln(5)\",\"x = ln(10)/2\",\"x = 2ln(10)\",\"x = ln(√10)\"],answer:\"B\",explanation:\"e^(2x) = 10\\n2x = ln(10)\\nx = ln(10)/2\"}];return questions[index%questions.length];}else if(topic==='Problem-Solving and Data Analysis'){// Problem-Solving question variants\nconst questions=[{id:\"math-data-\".concat(Date.now(),\"-\").concat(index),text:\"The table shows the number of students in different grade levels at a school. If a student is selected at random, what is the probability that the student is in 10th grade?\\n\\nGrade: 9th, 10th, 11th, 12th\\nNumber: 150, 130, 120, 100\",topic:\"Problem-Solving and Data Analysis\",difficulty:\"Medium\",options:[\"0.26\",\"0.30\",\"0.35\",\"0.40\"],answer:\"A\",explanation:\"Total number of students = 150 + 130 + 120 + 100 = 500\\nProbability = Number in 10th grade / Total = 130/500 = 0.26\"},{id:\"math-data-\".concat(Date.now(),\"-\").concat(index),text:\"A coffee shop sells medium coffees for $3.50 and large coffees for $4.25. If the shop sold a total of 150 coffees and collected $573.75, how many large coffees were sold?\",topic:\"Problem-Solving and Data Analysis\",difficulty:\"Medium\",options:[\"55\",\"75\",\"85\",\"95\"],answer:\"B\",explanation:\"Let x = number of large coffees and 150 - x = number of medium coffees.\\n4.25x + 3.50(150 - x) = 573.75\\n4.25x + 525 - 3.50x = 573.75\\n0.75x = 48.75\\nx = 65\"},{id:\"math-data-\".concat(Date.now(),\"-\").concat(index),text:\"The scatterplot shows the relationship between study time and test scores for 20 students. Based on the line of best fit, what is the predicted test score for a student who studies for 3 hours?\",topic:\"Problem-Solving and Data Analysis\",difficulty:\"Medium\",options:[\"72\",\"78\",\"84\",\"90\"],answer:\"C\",explanation:\"Using the equation of the line of best fit, y = 6x + 66, where x is hours studied and y is the test score: y = 6(3) + 66 = 18 + 66 = 84.\"},{id:\"math-data-\".concat(Date.now(),\"-\").concat(index),text:\"If the mean of a data set is 15 and the standard deviation is 3, approximately what percentage of the data falls within one standard deviation of the mean, assuming the data is normally distributed?\",topic:\"Problem-Solving and Data Analysis\",difficulty:\"Hard\",options:[\"50%\",\"68%\",\"95%\",\"99.7%\"],answer:\"B\",explanation:\"According to the empirical rule for normal distributions, approximately 68% of the data falls within one standard deviation of the mean (between 12 and 18 in this case).\"}];return questions[index%questions.length];}else{// Geometry question variants\nconst questions=[{id:\"math-geo-\".concat(Date.now(),\"-\").concat(index),text:\"In triangle ABC, if side AB = 6, side BC = 8, and angle B = 90°, what is the length of side AC?\",topic:\"Geometry and Trigonometry\",difficulty:\"Medium\",options:[\"8\",\"10\",\"12\",\"14\"],answer:\"B\",explanation:\"Since angle B = 90°, triangle ABC is a right triangle. Using the Pythagorean theorem: AC² = AB² + BC² = 6² + 8² = 36 + 64 = 100\\nTherefore, AC = √100 = 10\"},{id:\"math-geo-\".concat(Date.now(),\"-\").concat(index),text:\"What is the area of a circle with radius 6 cm?\",topic:\"Geometry and Trigonometry\",difficulty:\"Medium\",options:[\"12π cm²\",\"36π cm²\",\"72π cm²\",\"144π cm²\"],answer:\"B\",explanation:\"The area of a circle is A = πr². With r = 6 cm, the area is A = π(6)² = 36π cm².\"},{id:\"math-geo-\".concat(Date.now(),\"-\").concat(index),text:\"If sin(θ) = 3/5, what is the value of cos(θ)?\",topic:\"Geometry and Trigonometry\",difficulty:\"Medium\",options:[\"3/5\",\"4/5\",\"5/3\",\"5/4\"],answer:\"B\",explanation:\"Using the Pythagorean identity sin²(θ) + cos²(θ) = 1:\\ncos²(θ) = 1 - sin²(θ) = 1 - (3/5)² = 1 - 9/25 = 16/25\\ncos(θ) = √(16/25) = 4/5 (positive, assuming θ is in the first quadrant)\"},{id:\"math-geo-\".concat(Date.now(),\"-\").concat(index),text:\"A rectangular prism has dimensions 3 cm × 4 cm × 5 cm. What is its volume?\",topic:\"Geometry and Trigonometry\",difficulty:\"Easy\",options:[\"12 cm³\",\"47 cm³\",\"60 cm³\",\"120 cm³\"],answer:\"C\",explanation:\"The volume of a rectangular prism is V = l × w × h. With l = 3 cm, w = 4 cm, and h = 5 cm, the volume is V = 3 × 4 × 5 = 60 cm³.\"}];return questions[index%questions.length];}}};/**\n * Generates fallback questions if there's an error parsing the report or calling the API\n * @param text The original text input\n * @param count Number of questions to generate (default: 10)\n */const generateFallbackQuestions=function(text){let count=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;const questions=[];const topics=[\"Reading Comprehension\",\"Grammar and Language\",\"Algebra\",\"Geometry\",\"Data Analysis\",\"Vocabulary in Context\",\"Advanced Math\"];for(let i=0;i<count;i++){const topic=topics[i%topics.length];if(topic===\"Reading Comprehension\"){questions.push({id:\"fallback-rc-\".concat(Date.now(),\"-\").concat(i),text:\"What is the main purpose of the author in this passage?\",topic:\"Reading Comprehension\",difficulty:\"Medium\",options:[\"To persuade readers to take action on climate change\",\"To inform readers about recent scientific discoveries\",\"To compare different perspectives on a controversial issue\",\"To analyze the historical context of a current event\"],answer:\"B\",explanation:\"The passage primarily presents information about scientific discoveries without attempting to persuade, compare perspectives, or analyze history.\"});}else if(topic===\"Grammar and Language\"){questions.push({id:\"fallback-gram-\".concat(Date.now(),\"-\").concat(i),text:\"Which revision most effectively combines the underlined sentences?\\n'The museum acquired a new painting. It was created by a famous artist.'\",topic:\"Grammar and Language\",difficulty:\"Medium\",options:[\"The museum acquired a new painting, and it was created by a famous artist.\",\"The museum acquired a new painting that was created by a famous artist.\",\"The museum acquired a new painting; it was created by a famous artist.\",\"The museum acquired a new painting, which, it was created by a famous artist.\"],answer:\"B\",explanation:\"This option uses a relative clause to combine the sentences in the most concise and effective way.\"});}else if(topic===\"Algebra\"){questions.push({id:\"fallback-alg-\".concat(Date.now(),\"-\").concat(i),text:\"If 3x + 2y = 15 and 2x - y = 5, what is the value of x?\",topic:\"Algebra\",difficulty:\"Medium\",options:[\"3\",\"4\",\"5\",\"6\"],answer:\"B\",explanation:\"From 2x - y = 5, we get y = 2x - 5. Substituting into 3x + 2y = 15:\\n3x + 2(2x - 5) = 15\\n3x + 4x - 10 = 15\\n7x = 25\\nx = 25/7 = 4\"});}else if(topic===\"Geometry\"){questions.push({id:\"fallback-geo-\".concat(Date.now(),\"-\").concat(i),text:\"If a circle has a radius of 6, what is its area?\",topic:\"Geometry\",difficulty:\"Medium\",options:[\"36π\",\"12π\",\"18π\",\"24π\"],answer:\"A\",explanation:\"The area of a circle is given by the formula A = πr². With r = 6, A = π(6)² = 36π.\"});}else{questions.push({id:\"fallback-gen-\".concat(Date.now(),\"-\").concat(i),text:\"Which of the following best interprets the data in the given chart?\",topic:\"Data Analysis\",difficulty:\"Medium\",options:[\"The trend shows steady growth over the five-year period\",\"There was a sharp decline followed by a gradual recovery\",\"The highest values occurred in the middle of the time period\",\"The data shows cyclical patterns with regular intervals\"],answer:\"C\",explanation:\"The data in the chart shows peak values in the middle years of the time period, with lower values at the beginning and end.\"});}}return questions;};// Example of how you might call this (for testing purposes):\n/*\n(async () => {\n  const sampleText = \"User made mistakes in Algebra, particularly with quadratic equations. Also struggled with identifying the main idea in a reading passage.\";\n  try {\n    const questions = await generateQuestionsFromMistakes(sampleText);\n    console.log(\"Sample Generated Questions:\", questions);\n  } catch (error) {\n    console.error(\"Error generating sample questions:\", error);\n  }\n})();\n*/","map":{"version":3,"names":["ANALYSIS_API_KEY","process","env","REACT_APP_GEMINI_API_KEY","ANALYSIS_API_URL","addProcessingDelay","ms","Promise","resolve","setTimeout","parseSATReport","reportText","lines","split","data","sections","correct","incorrect","total","incorrectQuestions","totalCorrect","totalIncorrect","totalQuestions","totalQuestionsMatch","match","correctAnswersMatch","incorrectAnswersMatch","parseInt","sectionInfoRegex","sectionMatch","exec","topic","percentage","difficulty","mainSection","includes","sectionInfo","questionRegex","line","questionMatch","_","questionNumber","section","correctAnswer","yourAnswer","status","push","trim","Object","values","reduce","sum","determineTopics","createAnalysisPrompt","satData","_satData$sections$Rea","_satData$sections$Mat","incorrectRWCount","incorrectMathCount","prompt","concat","topics","entries","info","forEach","q","readingWeakTopics","mathWeakTopics","filter","_ref","map","_ref2","_ref3","_ref4","length","rwQuestions","Math","ceil","mathQuestions","join","callContentAPI","Error","apiUrl","payload","contents","parts","text","generationConfig","temperature","maxOutputTokens","response","fetch","method","headers","body","JSON","stringify","ok","errorText","json","console","log","generatedText","candidates","content","e","error","extractQuestionsFromResponse","jsonContent","jsonMatch","objectMatch","startsWith","startPos","indexOf","substring","endsWith","endPos","lastIndexOf","questions","parse","Array","isArray","index","id","Date","now","options","answer","explanation","message","generateQuestionsFromMistakes","extractedMistakesText","warn","analysisResponse","generatedQuestions","remainingQuestions","generateFallbackQuestions","slice","apiError","sectionsWithMistakes","_ref5","sort","a","b","totalSections","questionsPerSection","i","min","floor","random","generateQuestionForTopic","keys","count","arguments","undefined"],"sources":["/Users/gerardo/Downloads/Bonsaito/src/services/aiService.ts"],"sourcesContent":["// src/services/aiService.ts\n\n// Define the structure for a generated question\nexport interface GeneratedQuestion {\n  id: string;\n  text: string;         // The question itself\n  topic: string;        // The topic the question relates to (e.g., Algebra, Grammar)\n  difficulty?: string;  // Optional: e.g., Easy, Medium, Hard\n  options?: string[];   // Optional: For multiple-choice questions\n  answer?: string;      // Optional: The correct answer\n  explanation?: string; // Optional: Explanation for the answer\n}\n\n// Interface for topic difficulty information\ninterface TopicInfo {\n  percentage: number;\n  difficulty: string;\n}\n\n// Interface for section information\ninterface SectionTopicsInfo {\n  [topic: string]: TopicInfo;\n}\n\n// Interface for parsed SAT test data\ninterface SATTestData {\n  sections: {\n    [key: string]: {\n      correct: number;\n      incorrect: number;\n      total: number;\n      incorrectQuestions: Array<{\n        questionNumber: string;\n        correctAnswer: string;\n        yourAnswer: string;\n      }>;\n    }\n  };\n  totalCorrect: number;\n  totalIncorrect: number;\n  totalQuestions: number;\n  sectionInfo?: {\n    [section: string]: SectionTopicsInfo;\n  };\n}\n\n// Use environment variable for API key but rename it to be more generic\nconst ANALYSIS_API_KEY = process.env.REACT_APP_GEMINI_API_KEY;\nconst ANALYSIS_API_URL = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent\";\n\n// Function to simulate processing delay\nconst addProcessingDelay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\n/**\n * Parse SAT report text to extract information about incorrect answers\n */\nconst parseSATReport = (reportText: string): SATTestData => {\n  const lines = reportText.split('\\n');\n  \n  // Initialize data structure\n  const data: SATTestData = {\n    sections: {\n      'Reading and Writing': {\n        correct: 0,\n        incorrect: 0,\n        total: 0,\n        incorrectQuestions: []\n      },\n      'Math': {\n        correct: 0,\n        incorrect: 0,\n        total: 0,\n        incorrectQuestions: []\n      }\n    },\n    totalCorrect: 0,\n    totalIncorrect: 0,\n    totalQuestions: 0\n  };\n  \n  // First look for the summary data if available\n  const totalQuestionsMatch = reportText.match(/(\\d+)\\s*Total Questions/);\n  const correctAnswersMatch = reportText.match(/(\\d+)\\s*Correct Answers/);\n  const incorrectAnswersMatch = reportText.match(/(\\d+)\\s*Incorrect Answers/);\n  \n  if (totalQuestionsMatch) {\n    data.totalQuestions = parseInt(totalQuestionsMatch[1]);\n  }\n  \n  if (correctAnswersMatch) {\n    data.totalCorrect = parseInt(correctAnswersMatch[1]);\n  }\n  \n  if (incorrectAnswersMatch) {\n    data.totalIncorrect = parseInt(incorrectAnswersMatch[1]);\n  }\n  \n  // Try to extract information about each section's difficulty level\n  const sectionInfoRegex = /(Information and Ideas|Expression of Ideas|Craft and Structure|Standard English Conventions|Algebra|Advanced Math|Problem-Solving and Data Analysis|Geometry and Trigonometry)\\s*\\((\\d+)%[^)]*\\)(?:[^)]*Diﬃculty level: (Easy|Medium|Hard))?/g;\n  let sectionMatch;\n  \n  while ((sectionMatch = sectionInfoRegex.exec(reportText)) !== null) {\n    const topic = sectionMatch[1];\n    const percentage = parseInt(sectionMatch[2]);\n    const difficulty = sectionMatch[3] || \"Medium\";\n    \n    // Map topics to main sections\n    let mainSection = '';\n    if (['Information and Ideas', 'Expression of Ideas', 'Craft and Structure', 'Standard English Conventions'].includes(topic)) {\n      mainSection = 'Reading and Writing';\n    } else {\n      mainSection = 'Math';\n    }\n    \n    // Store this information for potential use in question generation\n    if (!data.sectionInfo) {\n      data.sectionInfo = {};\n    }\n    \n    if (!data.sectionInfo[mainSection]) {\n      data.sectionInfo[mainSection] = {};\n    }\n    \n    data.sectionInfo[mainSection][topic] = {\n      percentage,\n      difficulty\n    };\n  }\n  \n  // Extract test data row by row from the questions table\n  const questionRegex = /^\\s*(\\d+)\\s+(Reading and Writing|Math)\\s+([A-D0-9/\\., ]+)\\s+([A-D0-9/\\., ]+);?\\s*(Correct|Incorrect)/;\n  \n  for (const line of lines) {\n    const questionMatch = line.match(questionRegex);\n    \n    if (questionMatch) {\n      const [_, questionNumber, section, correctAnswer, yourAnswer, status] = questionMatch;\n      \n      if (section in data.sections) {\n        data.sections[section].total += 1;\n        \n        if (status === 'Correct') {\n          data.sections[section].correct += 1;\n        } else {\n          data.sections[section].incorrect += 1;\n          data.sections[section].incorrectQuestions.push({\n            questionNumber,\n            correctAnswer: correctAnswer.trim(),\n            yourAnswer: yourAnswer.trim()\n          });\n        }\n      }\n    }\n  }\n  \n  // If we couldn't parse the summary data directly, calculate from question data\n  if (data.totalQuestions === 0) {\n    data.totalCorrect = Object.values(data.sections).reduce((sum, section) => sum + section.correct, 0);\n    data.totalIncorrect = Object.values(data.sections).reduce((sum, section) => sum + section.incorrect, 0);\n    data.totalQuestions = data.totalCorrect + data.totalIncorrect;\n  }\n  \n  return data;\n};\n\n/**\n * Determines the main topics for each section based on mistakes\n */\nconst determineTopics = (section: string): string[] => {\n  if (section === 'Reading and Writing') {\n    return ['Information and Ideas', 'Expression of Ideas', 'Craft and Structure', 'Standard English Conventions'];\n  } else if (section === 'Math') {\n    return ['Algebra', 'Advanced Math', 'Problem-Solving and Data Analysis', 'Geometry and Trigonometry'];\n  }\n  return ['General Knowledge'];\n};\n\n/**\n * Creates a prompt for the analysis engine to generate SAT practice questions\n */\nconst createAnalysisPrompt = (satData: SATTestData): string => {\n  const incorrectRWCount = satData.sections['Reading and Writing']?.incorrect || 0;\n  const incorrectMathCount = satData.sections['Math']?.incorrect || 0;\n  \n  let prompt = `As an expert SAT tutor, create 10 unique SAT practice questions tailored to this student's specific performance on a recent SAT practice test.\n\nSTUDENT'S SAT REPORT SUMMARY:\n- Reading and Writing section: ${satData.sections['Reading and Writing'].correct} correct, ${satData.sections['Reading and Writing'].incorrect} incorrect\n- Math section: ${satData.sections['Math'].correct} correct, ${satData.sections['Math'].incorrect} incorrect\n- Total score: ${satData.totalCorrect} out of ${satData.totalQuestions}\n`;\n\n  // Add details about section difficulty levels if available\n  if (satData.sectionInfo) {\n    prompt += `\\nSECTION DIFFICULTY INFORMATION:\\n`;\n    \n    for (const [section, topics] of Object.entries(satData.sectionInfo)) {\n      prompt += `${section}:\\n`;\n      for (const [topic, info] of Object.entries(topics)) {\n        prompt += `- ${topic}: ${info.difficulty} difficulty (${info.percentage}% of section)\\n`;\n      }\n    }\n  }\n\n  // Add details about incorrect questions\n  if (incorrectRWCount > 0) {\n    prompt += `\\nREADING AND WRITING MISTAKES:\\n`;\n    satData.sections['Reading and Writing'].incorrectQuestions.forEach(q => {\n      prompt += `- Question ${q.questionNumber}: Student answered \"${q.yourAnswer}\" but correct answer was \"${q.correctAnswer}\"\\n`;\n    });\n  }\n  \n  if (incorrectMathCount > 0) {\n    prompt += `\\nMATH MISTAKES:\\n`;\n    satData.sections['Math'].incorrectQuestions.forEach(q => {\n      prompt += `- Question ${q.questionNumber}: Student answered \"${q.yourAnswer}\" but correct answer was \"${q.correctAnswer}\"\\n`;\n    });\n  }\n\n  // Analyze weak areas\n  let readingWeakTopics: string[] = [];\n  let mathWeakTopics: string[] = [];\n  \n  if (satData.sectionInfo) {\n    // For Reading and Writing, find topics with Hard difficulty\n    if (satData.sectionInfo['Reading and Writing']) {\n      readingWeakTopics = Object.entries(satData.sectionInfo['Reading and Writing'])\n        .filter(([_, info]) => info.difficulty === 'Hard' || incorrectRWCount > 5)\n        .map(([topic, _]) => topic);\n    }\n    \n    // For Math, find topics with Hard difficulty\n    if (satData.sectionInfo['Math']) {\n      mathWeakTopics = Object.entries(satData.sectionInfo['Math'])\n        .filter(([_, info]) => info.difficulty === 'Hard' || incorrectMathCount > 5)\n        .map(([topic, _]) => topic);\n    }\n  }\n  \n  // If we couldn't determine weak topics from section info, use default distribution\n  if (readingWeakTopics.length === 0) {\n    readingWeakTopics = ['Information and Ideas', 'Expression of Ideas', 'Craft and Structure', 'Standard English Conventions'];\n  }\n  \n  if (mathWeakTopics.length === 0) {\n    mathWeakTopics = ['Algebra', 'Advanced Math', 'Problem-Solving and Data Analysis', 'Geometry and Trigonometry'];\n  }\n\n  // Distribution of questions based on where student needs more practice\n  const rwQuestions = incorrectRWCount > 0 ? Math.ceil((incorrectRWCount / (incorrectRWCount + incorrectMathCount)) * 10) : 0;\n  const mathQuestions = 10 - rwQuestions;\n\n  prompt += `\\nBased on the student's performance, please create:\n${rwQuestions > 0 ? `- ${rwQuestions} Reading and Writing questions focusing on: ${readingWeakTopics.join(', ')}` : ''}\n${rwQuestions > 0 && mathQuestions > 0 ? '\\n' : ''}${mathQuestions > 0 ? `- ${mathQuestions} Math questions focusing on: ${mathWeakTopics.join(', ')}` : ''}\n\nFor Reading and Writing questions, cover these difficult topic areas:\n- Information and Ideas (comprehending texts, locating information)\n- Expression of Ideas (development, organization, effective language use)\n- Craft and Structure (word choice, text structure, point of view)\n- Standard English Conventions (grammar, usage, mechanics)\n\nFor Math questions, cover these topic areas:\n- Algebra (linear equations, systems, functions)\n- Advanced Math (quadratics, exponents, polynomials)\n- Problem-Solving and Data Analysis (ratios, percentages, statistics)\n- Geometry and Trigonometry (shapes, angles, triangles)\n\nFORMAT INSTRUCTIONS:\nReturn your response as a JSON array containing exactly 10 question objects with these fields:\n- id: A unique string identifier (e.g., \"rw-info-1\")\n- text: The question text\n- topic: The specific topic area (e.g., \"Algebra\", \"Information and Ideas\")\n- difficulty: \"Easy\", \"Medium\", or \"Hard\"\n- options: Array of 4 answer choices for multiple-choice questions\n- answer: The correct answer (letter A-D for multiple choice or exact answer for grid-ins)\n- explanation: Detailed explanation of the correct answer\n\nIMPORTANT REQUIREMENTS:\n1. Focus on the student's weak areas identified in the SAT report.\n2. For Reading questions: Create multiple-choice questions similar to those in SAT Reading.\n3. For Math questions: Create both multiple-choice and student-produced response questions (grid-ins).\n4. All questions should be original and at appropriate SAT difficulty level.\n5. Include high-quality explanations that teach the concept.\n6. Ensure questions reflect real SAT format and content.\n7. ENSURE THE RESPONSE IS VALID JSON that can be parsed with JSON.parse().\n\nExample format for ONE question (you'll provide 10):\n{\n  \"id\": \"math-alg-1\",\n  \"text\": \"If f(x) = 3x² - 4x + 2, what is the value of f(2)?\",\n  \"topic\": \"Algebra\",\n  \"difficulty\": \"Medium\",\n  \"options\": [\"6\", \"8\", \"10\", \"12\"],\n  \"answer\": \"C\",\n  \"explanation\": \"f(2) = 3(2)² - 4(2) + 2 = 3(4) - 8 + 2 = 12 - 8 + 2 = 6 + 2 = 10\"\n}`;\n\n  return prompt;\n};\n\n/**\n * Calls the external API to generate content\n */\nconst callContentAPI = async (prompt: string): Promise<string> => {\n  if (!ANALYSIS_API_KEY) {\n    throw new Error(\"API key not configured\");\n  }\n\n  const apiUrl = `${ANALYSIS_API_URL}?key=${ANALYSIS_API_KEY}`;\n\n  const payload = {\n    contents: [{\n      parts: [{\n        text: prompt\n      }]\n    }],\n    generationConfig: {\n      temperature: 0.7,\n      maxOutputTokens: 8192,\n    }\n  };\n\n  const response = await fetch(apiUrl, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(payload),\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(`API response error: ${response.status} ${errorText}`);\n  }\n\n  const data = await response.json();\n  console.log(\"API response received:\", data);\n\n  // Extract the generated text from the response\n  let generatedText = \"\";\n  try {\n    generatedText = data.candidates[0].content.parts[0].text;\n  } catch (e) {\n    console.error(\"Error extracting text from API response:\", e);\n    throw new Error(\"Unexpected API response format\");\n  }\n\n  return generatedText;\n};\n\n/**\n * Extracts structured question data from the API response\n */\nconst extractQuestionsFromResponse = (response: string): GeneratedQuestion[] => {\n  try {\n    // Find JSON array in the response (model might include other text before or after)\n    let jsonContent = response;\n    \n    // If the response contains markdown code blocks, extract just the JSON part\n    const jsonMatch = response.match(/```(?:json)?\\s*(\\[[\\s\\S]*?\\])\\s*```/);\n    if (jsonMatch && jsonMatch[1]) {\n      jsonContent = jsonMatch[1];\n    }\n    \n    // Sometimes the model may wrap JSON in an object instead of returning an array directly\n    // Check if we have a JSON object with a questions array\n    const objectMatch = jsonContent.match(/\\{\\s*\"questions\"\\s*:\\s*(\\[[\\s\\S]*?\\])\\s*\\}/);\n    if (objectMatch && objectMatch[1]) {\n      jsonContent = objectMatch[1];\n    }\n    \n    // Clean up any non-JSON content that might exist\n    jsonContent = jsonContent.trim();\n    if (!jsonContent.startsWith('[')) {\n      const startPos = jsonContent.indexOf('[');\n      if (startPos >= 0) {\n        jsonContent = jsonContent.substring(startPos);\n      }\n    }\n    if (!jsonContent.endsWith(']')) {\n      const endPos = jsonContent.lastIndexOf(']');\n      if (endPos >= 0) {\n        jsonContent = jsonContent.substring(0, endPos + 1);\n      }\n    }\n    \n    // Parse the JSON content\n    const questions = JSON.parse(jsonContent);\n    \n    // Validate that we have an array of questions with required properties\n    if (!Array.isArray(questions)) {\n      throw new Error(\"Parsed content is not an array\");\n    }\n    \n    // Ensure each question has required fields\n    return questions.map((q, index) => ({\n      id: q.id || `question-${Date.now()}-${index}`,\n      text: q.text || 'Question text unavailable',\n      topic: q.topic || 'General',\n      difficulty: q.difficulty,\n      options: q.options,\n      answer: q.answer,\n      explanation: q.explanation\n    }));\n  } catch (error: any) {\n    console.error(\"Error parsing API response:\", error, \"Raw response:\", response);\n    throw new Error(`Failed to parse questions from API response: ${error.message}`);\n  }\n};\n\n/**\n * Generates practice questions based on extracted text from an SAT report.\n * \n * @param extractedMistakesText The text extracted from the SAT report.\n * @returns A promise that resolves to an array of GeneratedQuestion objects.\n */\nexport const generateQuestionsFromMistakes = async (\n  extractedMistakesText: string\n): Promise<GeneratedQuestion[]> => {\n  console.log(\"Attempting to generate questions for text:\", extractedMistakesText.substring(0, 300) + \"...\");\n\n  if (!extractedMistakesText || extractedMistakesText.trim() === \"\") {\n    console.warn(\"No text provided for question generation.\");\n    return [];\n  }\n\n  try {\n    // 1. Parse the SAT report to understand mistakes\n    const satData = parseSATReport(extractedMistakesText);\n    console.log(\"Parsed SAT data:\", satData);\n    \n    // Add a processing delay to simulate complex analysis\n    await addProcessingDelay(3000);\n    \n    // 2. Generate questions based on the report\n    try {\n      // 2a. First try to use the advanced API if the key is available\n      if (ANALYSIS_API_KEY) {\n        console.log(\"Generating tailored questions using advanced analysis\");\n        const prompt = createAnalysisPrompt(satData);\n        \n        // Add additional delay to simulate API processing time\n        await addProcessingDelay(2000);\n        \n        const analysisResponse = await callContentAPI(prompt);\n        const generatedQuestions = extractQuestionsFromResponse(analysisResponse);\n        \n        // Ensure we have exactly 10 questions\n        if (generatedQuestions.length < 10) {\n          const remainingQuestions = generateFallbackQuestions(extractedMistakesText, 10 - generatedQuestions.length);\n          return [...generatedQuestions, ...remainingQuestions];\n        } else if (generatedQuestions.length > 10) {\n          return generatedQuestions.slice(0, 10);\n        }\n        \n        return generatedQuestions;\n      } else {\n        console.warn(\"No advanced analysis API key found. Using standard question generation.\");\n        throw new Error(\"Analysis API key not configured\");\n      }\n    } catch (apiError) {\n      console.error(\"Error using analysis API:\", apiError);\n      \n      // 2b. If API call fails, fall back to the template-based approach\n      console.log(\"Falling back to template-based question generation\");\n      \n      // Add a delay to simulate advanced processing\n      await addProcessingDelay(2500);\n      \n      const questions: GeneratedQuestion[] = [];\n      \n      // Get sections where mistakes were made\n      const sectionsWithMistakes = Object.entries(satData.sections)\n        .filter(([_, data]) => data.incorrect > 0)\n        .sort((a, b) => b[1].incorrect - a[1].incorrect);\n      \n      // If we have sections with mistakes, generate questions for those\n      if (sectionsWithMistakes.length > 0) {\n        // Determine how many questions per section\n        const totalSections = sectionsWithMistakes.length;\n        const questionsPerSection = Math.ceil(10 / totalSections);\n        \n        // Generate questions for each section\n        for (const [section, data] of sectionsWithMistakes) {\n          const topics = determineTopics(section);\n          \n          for (let i = 0; i < Math.min(questionsPerSection, data.incorrect, 10); i++) {\n            const topic = topics[Math.floor(Math.random() * topics.length)];\n            \n            questions.push(generateQuestionForTopic(section, topic, i));\n            \n            if (questions.length >= 10) break;\n          }\n          \n          if (questions.length >= 10) break;\n        }\n      }\n      \n      // If we still don't have 10 questions, add more generic ones\n      while (questions.length < 10) {\n        const section = Object.keys(satData.sections)[Math.floor(Math.random() * Object.keys(satData.sections).length)];\n        const topics = determineTopics(section);\n        const topic = topics[Math.floor(Math.random() * topics.length)];\n        \n        questions.push(generateQuestionForTopic(section, topic, questions.length));\n      }\n      \n      console.log(\"Generated questions:\", questions);\n      return questions;\n    }\n  } catch (error) {\n    console.error(\"Error parsing SAT report:\", error);\n    return generateFallbackQuestions(extractedMistakesText, 10);\n  }\n};\n\n/**\n * Generates a question for a specific topic\n */\nconst generateQuestionForTopic = (section: string, topic: string, index: number): GeneratedQuestion => {\n  // Create varied questions for each topic based on the index\n  if (section === 'Reading and Writing') {\n    if (topic === 'Information and Ideas') {\n      // Information and Ideas question variants\n      const questions = [\n        {\n          id: `rw-info-${Date.now()}-${index}`,\n          text: \"Which statement best summarizes the main idea of the passage?\",\n          topic: \"Information and Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"The economic impact of renewable energy on global markets\",\n            \"The scientific advancements that enable modern solar technology\",\n            \"The historical development of energy technology across cultures\",\n            \"The environmental benefits of transitioning to renewable energy sources\"\n          ],\n          answer: \"D\",\n          explanation: \"The passage primarily discusses the environmental benefits of renewable energy rather than focusing on economic, scientific, or historical aspects.\"\n        },\n        {\n          id: `rw-info-${Date.now()}-${index}`,\n          text: \"Which detail from the passage best supports the author's claim about climate impacts?\",\n          topic: \"Information and Ideas\",\n          difficulty: \"Hard\",\n          options: [\n            \"The statistical analysis of temperature changes over fifty years\",\n            \"The quotation from the environmental scientist in paragraph 3\",\n            \"The comparison between different energy production methods\",\n            \"The reference to the international climate agreement\"\n          ],\n          answer: \"B\",\n          explanation: \"The quotation from the environmental scientist provides specific evidence that directly supports the author's central claim about climate impacts.\"\n        },\n        {\n          id: `rw-info-${Date.now()}-${index}`,\n          text: \"Based on the passage, what can be inferred about the relationship between technology and sustainability?\",\n          topic: \"Information and Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"Technological advancement always leads to environmental degradation\",\n            \"Sustainability goals can be achieved without technological innovation\",\n            \"Technology can be harnessed to address environmental challenges\",\n            \"Environmental concerns are secondary to technological progress\"\n          ],\n          answer: \"C\",\n          explanation: \"The passage implies that properly directed technological innovation can help address environmental challenges rather than exacerbate them.\"\n        },\n        {\n          id: `rw-info-${Date.now()}-${index}`,\n          text: \"What conclusion about renewable energy is best supported by the data presented in the passage?\",\n          topic: \"Information and Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"It is more cost-effective than fossil fuels in all contexts\",\n            \"Its adoption is growing faster in developing countries than in industrialized nations\",\n            \"It has the potential to significantly reduce carbon emissions\",\n            \"It will completely replace traditional energy sources within a decade\"\n          ],\n          answer: \"C\",\n          explanation: \"The data in the passage directly supports the conclusion that renewable energy can significantly reduce carbon emissions, without making unsupported claims about cost-effectiveness, adoption rates, or timeline predictions.\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else if (topic === 'Expression of Ideas') {\n      // Expression of Ideas question variants\n      const questions = [\n        {\n          id: `rw-expr-${Date.now()}-${index}`,\n          text: \"Which sentence would most effectively establish the main idea of the paragraph?\",\n          topic: \"Expression of Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"The author's opinion represents only one perspective on the issue.\",\n            \"Research indicates that several factors contribute to this phenomenon.\",\n            \"Traditional approaches to solving this problem have proven ineffective.\",\n            \"Personal biases often influence how people interpret complex data.\"\n          ],\n          answer: \"C\",\n          explanation: \"This option establishes context and signals that the paragraph will explore new approaches, creating a clear focus.\"\n        },\n        {\n          id: `rw-expr-${Date.now()}-${index}`,\n          text: \"Which revision most effectively combines these two sentences?\\n'The museum opened a new exhibit. The exhibit features artifacts from ancient Egypt.'\",\n          topic: \"Expression of Ideas\",\n          difficulty: \"Easy\",\n          options: [\n            \"The museum opened a new exhibit and features artifacts from ancient Egypt.\",\n            \"The museum opened a new exhibit, it features artifacts from ancient Egypt.\",\n            \"The museum opened a new exhibit that features artifacts from ancient Egypt.\",\n            \"The museum, opening a new exhibit, features artifacts from ancient Egypt.\"\n          ],\n          answer: \"C\",\n          explanation: \"This revision most effectively combines the sentences using a relative clause that clearly shows the relationship between the exhibit and the artifacts.\"\n        },\n        {\n          id: `rw-expr-${Date.now()}-${index}`,\n          text: \"Which transition would best connect the ideas in these two paragraphs?\",\n          topic: \"Expression of Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"Furthermore\",\n            \"Nevertheless\",\n            \"For example\",\n            \"In conclusion\"\n          ],\n          answer: \"B\",\n          explanation: \"Since the second paragraph presents a contrasting perspective to the first, 'Nevertheless' is the most appropriate transition to indicate this shift.\"\n        },\n        {\n          id: `rw-expr-${Date.now()}-${index}`,\n          text: \"Where should this sentence be placed to best support the paragraph's main argument?\\n'Recent studies have confirmed this trend across multiple demographics.'\",\n          topic: \"Expression of Ideas\",\n          difficulty: \"Medium\",\n          options: [\n            \"Before the topic sentence to foreshadow the argument\",\n            \"After the first supporting point as additional evidence\",\n            \"After the counterargument to strengthen the rebuttal\",\n            \"At the end of the paragraph as a concluding thought\"\n          ],\n          answer: \"B\",\n          explanation: \"Placing this sentence after the first supporting point provides additional evidence that strengthens the initial claim, creating a more compelling argument.\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else if (topic === 'Craft and Structure') {\n      // Craft and Structure question variants\n      const questions = [\n        {\n          id: `rw-craft-${Date.now()}-${index}`,\n          text: \"What purpose does the author's reference to historical events serve in the passage?\",\n          topic: \"Craft and Structure\",\n          difficulty: \"Hard\",\n          options: [\n            \"To establish credibility through detailed knowledge\",\n            \"To provide context for a contemporary issue\",\n            \"To challenge conventional interpretations of history\",\n            \"To appeal to readers' sense of nostalgia\"\n          ],\n          answer: \"B\",\n          explanation: \"The historical references function primarily to provide context that helps readers understand the current situation being discussed.\"\n        },\n        {\n          id: `rw-craft-${Date.now()}-${index}`,\n          text: \"How does the author's use of technical language in paragraph 3 affect the passage?\",\n          topic: \"Craft and Structure\",\n          difficulty: \"Medium\",\n          options: [\n            \"It creates distance between the reader and the subject matter\",\n            \"It emphasizes the complexity and importance of the scientific concepts\",\n            \"It undermines the credibility of competing theories\",\n            \"It shifts the tone from objective to persuasive\"\n          ],\n          answer: \"B\",\n          explanation: \"The technical language emphasizes the complexity and scientific significance of the concepts being discussed, adding depth to the author's explanation.\"\n        },\n        {\n          id: `rw-craft-${Date.now()}-${index}`,\n          text: \"In the context of the passage, the word 'paradigm' most nearly means:\",\n          topic: \"Craft and Structure\",\n          difficulty: \"Medium\",\n          options: [\n            \"A contradiction or paradox\",\n            \"An established model or pattern\",\n            \"A temporary solution\",\n            \"An unexpected discovery\"\n          ],\n          answer: \"B\",\n          explanation: \"In this context, 'paradigm' refers to an established model or pattern of thinking that shapes how a field approaches problems.\"\n        },\n        {\n          id: `rw-craft-${Date.now()}-${index}`,\n          text: \"How does the structure of the passage develop the author's argument?\",\n          topic: \"Craft and Structure\",\n          difficulty: \"Hard\",\n          options: [\n            \"By presenting a chronological narrative of events\",\n            \"By comparing and contrasting different perspectives\",\n            \"By stating a problem and then proposing solutions\",\n            \"By making a claim and supporting it with increasingly specific evidence\"\n          ],\n          answer: \"D\",\n          explanation: \"The passage begins with a general claim and then develops it by providing increasingly specific evidence, creating a logical progression that strengthens the argument.\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else {\n      // Standard English Conventions question variants\n      const questions = [\n        {\n          id: `rw-conv-${Date.now()}-${index}`,\n          text: \"Which revision corrects the grammatical error in the sentence?\\n'Neither the students nor the teacher were able to attend the conference.'\",\n          topic: \"Standard English Conventions\",\n          difficulty: \"Medium\",\n          options: [\n            \"Neither the students nor the teacher was able to attend the conference.\",\n            \"Neither the students nor the teacher being able to attend the conference.\",\n            \"Neither the students nor the teacher have been able to attend the conference.\",\n            \"No correction is needed.\"\n          ],\n          answer: \"A\",\n          explanation: \"When 'neither/nor' is used, the verb should agree with the noun closer to it (in this case 'teacher'), which requires the singular 'was' rather than 'were'.\"\n        },\n        {\n          id: `rw-conv-${Date.now()}-${index}`,\n          text: \"Which revision corrects the punctuation error in this sentence?\\n'The committee reviewed the proposal however they requested additional information.'\",\n          topic: \"Standard English Conventions\",\n          difficulty: \"Medium\",\n          options: [\n            \"The committee reviewed the proposal, however they requested additional information.\",\n            \"The committee reviewed the proposal; however, they requested additional information.\",\n            \"The committee reviewed the proposal, however, they requested additional information.\",\n            \"The committee reviewed the proposal however, they requested additional information.\"\n          ],\n          answer: \"B\",\n          explanation: \"When 'however' joins two independent clauses, it should be preceded by a semicolon and followed by a comma to properly separate the clauses.\"\n        },\n        {\n          id: `rw-conv-${Date.now()}-${index}`,\n          text: \"Which choice correctly uses the apostrophe?\",\n          topic: \"Standard English Conventions\",\n          difficulty: \"Easy\",\n          options: [\n            \"The dog wagged it's tail excitedly.\",\n            \"The companies' new policy affected all employees.\",\n            \"The children's toys were scattered across the floor's.\",\n            \"The building's' entrance was being renovated.\"\n          ],\n          answer: \"B\",\n          explanation: \"This option correctly uses the apostrophe after 'companies' to show possession by multiple companies (plural possessive).\"\n        },\n        {\n          id: `rw-conv-${Date.now()}-${index}`,\n          text: \"Which sentence uses parallel structure correctly?\",\n          topic: \"Standard English Conventions\",\n          difficulty: \"Medium\",\n          options: [\n            \"She enjoys swimming, hiking, and to ride bicycles.\",\n            \"The candidate promised to lower taxes, creating jobs, and improving education.\",\n            \"The professor asked students to read the chapter, take notes, and submit a summary.\",\n            \"We can either finish the project today or waiting until tomorrow.\"\n          ],\n          answer: \"C\",\n          explanation: \"This sentence correctly maintains parallel structure by using the same verb form (infinitive) for all three actions: 'to read,' 'take,' and 'submit.'\"\n        }\n      ];\n      return questions[index % questions.length];\n    }\n  } else {\n    if (topic === 'Algebra') {\n      // Algebra question variants\n      const questions = [\n        {\n          id: `math-alg-${Date.now()}-${index}`,\n          text: \"If f(x) = 3x² - 4x + 2, what is the value of f(2)?\",\n          topic: \"Algebra\",\n          difficulty: \"Medium\",\n          options: [\n            \"6\",\n            \"8\",\n            \"10\",\n            \"12\"\n          ],\n          answer: \"C\",\n          explanation: \"f(2) = 3(2)² - 4(2) + 2 = 3(4) - 8 + 2 = 12 - 8 + 2 = 6 + 2 = 10\"\n        },\n        {\n          id: `math-alg-${Date.now()}-${index}`,\n          text: \"Solve for x: 2x - 5 = 3x + 7\",\n          topic: \"Algebra\",\n          difficulty: \"Easy\",\n          options: [\n            \"x = -12\",\n            \"x = -1\",\n            \"x = 2\",\n            \"x = 12\"\n          ],\n          answer: \"A\",\n          explanation: \"2x - 5 = 3x + 7\\n2x - 3x = 7 + 5\\n-x = 12\\nx = -12\"\n        },\n        {\n          id: `math-alg-${Date.now()}-${index}`,\n          text: \"Which of the following is equivalent to (x + 3)(x - 2)?\",\n          topic: \"Algebra\",\n          difficulty: \"Medium\",\n          options: [\n            \"x² + x - 6\",\n            \"x² + x + 6\",\n            \"x² + 5x - 6\",\n            \"x² - 5x - 6\"\n          ],\n          answer: \"A\",\n          explanation: \"(x + 3)(x - 2) = x² - 2x + 3x - 6 = x² + x - 6\"\n        },\n        {\n          id: `math-alg-${Date.now()}-${index}`,\n          text: \"If 3(2x - 4) = 18, what is the value of x?\",\n          topic: \"Algebra\",\n          difficulty: \"Easy\",\n          options: [\n            \"1\",\n            \"3\", \n            \"4\",\n            \"5\"\n          ],\n          answer: \"D\",\n          explanation: \"3(2x - 4) = 18\\n6x - 12 = 18\\n6x = 30\\nx = 5\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else if (topic === 'Advanced Math') {\n      // Advanced Math question variants\n      const questions = [\n        {\n          id: `math-adv-${Date.now()}-${index}`,\n          text: \"Which of the following is equivalent to (2x + 5)(x - 3) - (x + 1)(x - 4)?\",\n          topic: \"Advanced Math\",\n          difficulty: \"Hard\",\n          options: [\n            \"x² - 3x - 17\",\n            \"x² - 5x - 19\",\n            \"x² + 3x - 17\",\n            \"x² + 5x - 19\"\n          ],\n          answer: \"B\",\n          explanation: \"(2x + 5)(x - 3) - (x + 1)(x - 4)\\n= 2x² - 6x + 5x - 15 - (x² - 4x + x - 4)\\n= 2x² - x - 15 - x² + 3x + 4\\n= x² - x - 15 + 3x + 4\\n= x² + 2x - 11\"\n        },\n        {\n          id: `math-adv-${Date.now()}-${index}`,\n          text: \"If log₃(x) = 4, what is the value of x?\",\n          topic: \"Advanced Math\",\n          difficulty: \"Medium\",\n          options: [\n            \"12\",\n            \"64\",\n            \"81\",\n            \"243\"\n          ],\n          answer: \"C\",\n          explanation: \"If log₃(x) = 4, then 3⁴ = x. So x = 3⁴ = 81.\"\n        },\n        {\n          id: `math-adv-${Date.now()}-${index}`,\n          text: \"Which of the following is equivalent to sin²(θ) + cos²(θ)?\",\n          topic: \"Advanced Math\",\n          difficulty: \"Medium\",\n          options: [\n            \"0\",\n            \"1\",\n            \"tan²(θ)\",\n            \"2sin(θ)cos(θ)\"\n          ],\n          answer: \"B\",\n          explanation: \"By the Pythagorean identity, sin²(θ) + cos²(θ) = 1 for all values of θ.\"\n        },\n        {\n          id: `math-adv-${Date.now()}-${index}`,\n          text: \"What is the solution to the equation e^(2x) = 10?\",\n          topic: \"Advanced Math\",\n          difficulty: \"Hard\",\n          options: [\n            \"x = ln(5)\",\n            \"x = ln(10)/2\",\n            \"x = 2ln(10)\",\n            \"x = ln(√10)\"\n          ],\n          answer: \"B\",\n          explanation: \"e^(2x) = 10\\n2x = ln(10)\\nx = ln(10)/2\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else if (topic === 'Problem-Solving and Data Analysis') {\n      // Problem-Solving question variants\n      const questions = [\n        {\n          id: `math-data-${Date.now()}-${index}`,\n          text: \"The table shows the number of students in different grade levels at a school. If a student is selected at random, what is the probability that the student is in 10th grade?\\n\\nGrade: 9th, 10th, 11th, 12th\\nNumber: 150, 130, 120, 100\",\n          topic: \"Problem-Solving and Data Analysis\",\n          difficulty: \"Medium\",\n          options: [\n            \"0.26\",\n            \"0.30\",\n            \"0.35\",\n            \"0.40\"\n          ],\n          answer: \"A\",\n          explanation: \"Total number of students = 150 + 130 + 120 + 100 = 500\\nProbability = Number in 10th grade / Total = 130/500 = 0.26\"\n        },\n        {\n          id: `math-data-${Date.now()}-${index}`,\n          text: \"A coffee shop sells medium coffees for $3.50 and large coffees for $4.25. If the shop sold a total of 150 coffees and collected $573.75, how many large coffees were sold?\",\n          topic: \"Problem-Solving and Data Analysis\",\n          difficulty: \"Medium\",\n          options: [\n            \"55\",\n            \"75\",\n            \"85\",\n            \"95\"\n          ],\n          answer: \"B\",\n          explanation: \"Let x = number of large coffees and 150 - x = number of medium coffees.\\n4.25x + 3.50(150 - x) = 573.75\\n4.25x + 525 - 3.50x = 573.75\\n0.75x = 48.75\\nx = 65\"\n        },\n        {\n          id: `math-data-${Date.now()}-${index}`,\n          text: \"The scatterplot shows the relationship between study time and test scores for 20 students. Based on the line of best fit, what is the predicted test score for a student who studies for 3 hours?\",\n          topic: \"Problem-Solving and Data Analysis\",\n          difficulty: \"Medium\",\n          options: [\n            \"72\",\n            \"78\",\n            \"84\",\n            \"90\"\n          ],\n          answer: \"C\",\n          explanation: \"Using the equation of the line of best fit, y = 6x + 66, where x is hours studied and y is the test score: y = 6(3) + 66 = 18 + 66 = 84.\"\n        },\n        {\n          id: `math-data-${Date.now()}-${index}`,\n          text: \"If the mean of a data set is 15 and the standard deviation is 3, approximately what percentage of the data falls within one standard deviation of the mean, assuming the data is normally distributed?\",\n          topic: \"Problem-Solving and Data Analysis\",\n          difficulty: \"Hard\",\n          options: [\n            \"50%\",\n            \"68%\",\n            \"95%\",\n            \"99.7%\"\n          ],\n          answer: \"B\",\n          explanation: \"According to the empirical rule for normal distributions, approximately 68% of the data falls within one standard deviation of the mean (between 12 and 18 in this case).\"\n        }\n      ];\n      return questions[index % questions.length];\n    } else {\n      // Geometry question variants\n      const questions = [\n        {\n          id: `math-geo-${Date.now()}-${index}`,\n          text: \"In triangle ABC, if side AB = 6, side BC = 8, and angle B = 90°, what is the length of side AC?\",\n          topic: \"Geometry and Trigonometry\",\n          difficulty: \"Medium\",\n          options: [\n            \"8\",\n            \"10\",\n            \"12\",\n            \"14\"\n          ],\n          answer: \"B\",\n          explanation: \"Since angle B = 90°, triangle ABC is a right triangle. Using the Pythagorean theorem: AC² = AB² + BC² = 6² + 8² = 36 + 64 = 100\\nTherefore, AC = √100 = 10\"\n        },\n        {\n          id: `math-geo-${Date.now()}-${index}`,\n          text: \"What is the area of a circle with radius 6 cm?\",\n          topic: \"Geometry and Trigonometry\",\n          difficulty: \"Medium\",\n          options: [\n            \"12π cm²\",\n            \"36π cm²\",\n            \"72π cm²\",\n            \"144π cm²\"\n          ],\n          answer: \"B\",\n          explanation: \"The area of a circle is A = πr². With r = 6 cm, the area is A = π(6)² = 36π cm².\"\n        },\n        {\n          id: `math-geo-${Date.now()}-${index}`,\n          text: \"If sin(θ) = 3/5, what is the value of cos(θ)?\",\n          topic: \"Geometry and Trigonometry\",\n          difficulty: \"Medium\",\n          options: [\n            \"3/5\",\n            \"4/5\",\n            \"5/3\",\n            \"5/4\"\n          ],\n          answer: \"B\",\n          explanation: \"Using the Pythagorean identity sin²(θ) + cos²(θ) = 1:\\ncos²(θ) = 1 - sin²(θ) = 1 - (3/5)² = 1 - 9/25 = 16/25\\ncos(θ) = √(16/25) = 4/5 (positive, assuming θ is in the first quadrant)\"\n        },\n        {\n          id: `math-geo-${Date.now()}-${index}`,\n          text: \"A rectangular prism has dimensions 3 cm × 4 cm × 5 cm. What is its volume?\",\n          topic: \"Geometry and Trigonometry\",\n          difficulty: \"Easy\",\n          options: [\n            \"12 cm³\",\n            \"47 cm³\",\n            \"60 cm³\",\n            \"120 cm³\"\n          ],\n          answer: \"C\",\n          explanation: \"The volume of a rectangular prism is V = l × w × h. With l = 3 cm, w = 4 cm, and h = 5 cm, the volume is V = 3 × 4 × 5 = 60 cm³.\"\n        }\n      ];\n      return questions[index % questions.length];\n    }\n  }\n};\n\n/**\n * Generates fallback questions if there's an error parsing the report or calling the API\n * @param text The original text input\n * @param count Number of questions to generate (default: 10)\n */\nconst generateFallbackQuestions = (text: string, count: number = 10): GeneratedQuestion[] => {\n  const questions: GeneratedQuestion[] = [];\n  const topics = [\n    \"Reading Comprehension\", \"Grammar and Language\", \"Algebra\", \"Geometry\", \n    \"Data Analysis\", \"Vocabulary in Context\", \"Advanced Math\"\n  ];\n  \n  for (let i = 0; i < count; i++) {\n    const topic = topics[i % topics.length];\n    \n    if (topic === \"Reading Comprehension\") {\n      questions.push({\n        id: `fallback-rc-${Date.now()}-${i}`,\n        text: \"What is the main purpose of the author in this passage?\",\n        topic: \"Reading Comprehension\",\n        difficulty: \"Medium\",\n        options: [\n          \"To persuade readers to take action on climate change\",\n          \"To inform readers about recent scientific discoveries\",\n          \"To compare different perspectives on a controversial issue\",\n          \"To analyze the historical context of a current event\"\n        ],\n        answer: \"B\",\n        explanation: \"The passage primarily presents information about scientific discoveries without attempting to persuade, compare perspectives, or analyze history.\"\n      });\n    } else if (topic === \"Grammar and Language\") {\n      questions.push({\n        id: `fallback-gram-${Date.now()}-${i}`,\n        text: \"Which revision most effectively combines the underlined sentences?\\n'The museum acquired a new painting. It was created by a famous artist.'\",\n        topic: \"Grammar and Language\",\n        difficulty: \"Medium\",\n        options: [\n          \"The museum acquired a new painting, and it was created by a famous artist.\",\n          \"The museum acquired a new painting that was created by a famous artist.\",\n          \"The museum acquired a new painting; it was created by a famous artist.\",\n          \"The museum acquired a new painting, which, it was created by a famous artist.\"\n        ],\n        answer: \"B\",\n        explanation: \"This option uses a relative clause to combine the sentences in the most concise and effective way.\"\n      });\n    } else if (topic === \"Algebra\") {\n      questions.push({\n        id: `fallback-alg-${Date.now()}-${i}`,\n        text: \"If 3x + 2y = 15 and 2x - y = 5, what is the value of x?\",\n        topic: \"Algebra\",\n        difficulty: \"Medium\",\n        options: [\"3\", \"4\", \"5\", \"6\"],\n        answer: \"B\",\n        explanation: \"From 2x - y = 5, we get y = 2x - 5. Substituting into 3x + 2y = 15:\\n3x + 2(2x - 5) = 15\\n3x + 4x - 10 = 15\\n7x = 25\\nx = 25/7 = 4\"\n      });\n    } else if (topic === \"Geometry\") {\n      questions.push({\n        id: `fallback-geo-${Date.now()}-${i}`,\n        text: \"If a circle has a radius of 6, what is its area?\",\n        topic: \"Geometry\",\n        difficulty: \"Medium\",\n        options: [\"36π\", \"12π\", \"18π\", \"24π\"],\n        answer: \"A\",\n        explanation: \"The area of a circle is given by the formula A = πr². With r = 6, A = π(6)² = 36π.\"\n      });\n    } else {\n      questions.push({\n        id: `fallback-gen-${Date.now()}-${i}`,\n        text: \"Which of the following best interprets the data in the given chart?\",\n        topic: \"Data Analysis\",\n        difficulty: \"Medium\",\n        options: [\n          \"The trend shows steady growth over the five-year period\",\n          \"There was a sharp decline followed by a gradual recovery\",\n          \"The highest values occurred in the middle of the time period\",\n          \"The data shows cyclical patterns with regular intervals\"\n        ],\n        answer: \"C\",\n        explanation: \"The data in the chart shows peak values in the middle years of the time period, with lower values at the beginning and end.\"\n      });\n    }\n  }\n  \n  return questions;\n};\n\n// Example of how you might call this (for testing purposes):\n/*\n(async () => {\n  const sampleText = \"User made mistakes in Algebra, particularly with quadratic equations. Also struggled with identifying the main idea in a reading passage.\";\n  try {\n    const questions = await generateQuestionsFromMistakes(sampleText);\n    console.log(\"Sample Generated Questions:\", questions);\n  } catch (error) {\n    console.error(\"Error generating sample questions:\", error);\n  }\n})();\n*/ "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}